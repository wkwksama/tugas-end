(function(){Aedu.SignupToDownload||(Aedu.SignupToDownload={}),Aedu.SignupToDownload.notifier=new c.Server.Notification("sutd"),Aedu.SignupToDownload.notifier.notifyAndLog=function(t,e){return null==e&&(e={}),$a.log(t),this.notify({event_type:t,attachment_id:e.attachment_id?e.attachment_id:void 0,auvid:$auvid,location:e.location?e.location:void 0,error:e.error?e.error:void 0})}}).call(this),function(){this.JST||(this.JST={}),this.JST["signup_to_download/templates/layout"]=function(t){var e,i=[],s=t||{};return function(t,s,o,n,a,l){i.push('<div class="DesignSystem"><div style="width:460px" class="modal-dialog"><div class="modal-content u-overflowHidden"><div class="modal-header container-fluid u-p0x"><div class="row u-pv6x"><div class="col-xs-8 col-xs-offset-2"><div class="u-taCenter u-fs14 u-fw700 u-tcGrayDarkest u-textUppercase u-letterSpacing1">'+jade.escape(null==(e=l)?"":e)+"</div></div>"),a&&i.push('<div class="col-xs-2"><button data-dismiss="modal" class="js-close-full-modal u-floatRight Close u-fw400 u-fs20 u-mr4x">&times;</button></div>'),i.push('</div></div><div class="modal-body container-fluid u-p10x"><div class="row u-mb10x"><div class="col-xs-12"><div class="u-taCenter"><div class="u-tcGrayDarkest u-lineHeight1_4 u-fontSerif u-fs22">'+jade.escape(null==(e=n)?"":e)+'</div></div></div></div><div class="row u-mb5x"><div class="col-xs-6 u-pr2x"><button id="google-signup-button" class="Button Button--google Button--block Button--lg"><i class="fa fa-google-plus fa-lg"></i>&nbsp;&nbsp;Connect</button></div><div class="col-xs-6 u-pl2x"><button id="fb-signup-button" class="Button Button--facebook Button--block Button--lg"><i class="fa fa-facebook-square fa-lg"></i>&nbsp;&nbsp;Connect</button></div></div><div class="row u-mb5x"><div class="col-xs-12"><div class="hr-heading login-hr-heading"><span class="hr-heading-text">or</span></div></div></div><form class="js-modal-title-form container-fluid"><div class="row u-mb5x"><div class="col-xs-12 u-ph0x TextInputWrapper--icon u-floatLeft"><input placeholder="Email" type="email" id="user_email" class="TextInput TextInput--xl js-modal-title-email swp-splash-single-step-singup-input"/><i class="fa fa-envelope-o u-tcGrayDark js-modal-title-envelope"></i></div></div><div class="row"><div class="col-xs-12 collapse js-modal-title-form-collapsed"><div class="row u-mb5x"><div class="col-xs-6 u-pl0x u-pr2x"><input placeholder="First Name" id="user_first_name" class="TextInput TextInput--xl js-modal-title-first-name swp-splash-single-step-singup-input"/></div><div class="col-xs-6 u-pl2x u-pr0x"><div class="u-positionRelative"><input placeholder="Last Name" id="user_last_name" class="TextInput TextInput--xl js-modal-title-last-name swp-splash-single-step-singup-input"/></div></div></div><div class="row u-mb5x"><div class="col-xs-12 u-ph0x"><input type="password" placeholder="Password" id="user_password" class="TextInput TextInput--xl js-modal-title-password swp-splash-single-step-singup-input"/></div></div><div class="row u-mb5x"><div class="col-xs-12 u-ph0x"><button type="submit" class="js-modal-signup-submit swp-splash-signup-submit Button Button--block Button--lg Button--green">'),s?i.push(jade.escape(null==(e=s)?"":e)):i.push("<i"+jade.cls(["fa","fa-lg","pdf"===t?"fa-file-pdf-o":"fa-file-text-o"],[null,null,!0])+"></i>&nbsp;&nbsp;\nGET "+jade.escape(null==(e="pdf"===t?"PDF":"FILE")?"":e)),i.push('</button></div></div></div></div><div class="row"><div class="col-xs-12 u-ph0x u-taCenter"><div class="u-fw400 u-fs12 u-tcGrayDark">Already have an account?\n&nbsp;<a'+jade.attr("href",o,!0,!1)+' class="u-linkUnstyled u-textDecorationUnderline u-tcBlue">Log in</a></div></div></div></form></div></div></div></div>')}.call(this,"attachmentType"in s?s.attachmentType:"undefined"!=typeof attachmentType?attachmentType:undefined,"buttonText"in s?s.buttonText:"undefined"!=typeof buttonText?buttonText:undefined,"loginUrl"in s?s.loginUrl:"undefined"!=typeof loginUrl?loginUrl:undefined,"message"in s?s.message:"undefined"!=typeof message?message:undefined,"showCloseButton"in s?s.showCloseButton:"undefined"!=typeof showCloseButton?showCloseButton:undefined,"title"in s?s.title:"undefined"!=typeof title?title:undefined),i.join("")}}.call(this),function(){Aedu.SignupToDownload.Layout=Backbone.View.extend({template:"signup_to_download/templates/layout",className:"modal fade",events:{"focus .js-modal-title-email":"expandEmailForm","click .js-modal-signup-submit":"submitSignup","click .js-modal-terms-link":"termsClicked","keydown .js-modal-title-first-name":"logTyping","keydown .js-modal-title-last-name":"logTyping","keydown .js-modal-title-password":"logTyping","keydown .js-modal-title-email":"logTyping"},initialize:function(t){return null==t&&(t={}),this.model=new MobileRegPath.newUser({attachment_id:t.attachmentId,login_redirect:t.loginRedirect,user_source:t.userSource}),this.data={loginUrl:t.loginUrl||"/login",message:t.message,attachmentType:null!=t.attachmentType?t.attachmentType:void 0,title:t.title,buttonText:t.buttonText,showCloseButton:t.showCloseButton},this.log={user_email:!1,user_first_name:!1,user_last_name:!1,user_password:!1},this.render(this.data)},render:function(t){return this.$el.html(JST[this.template](t)),this.postRender()},postRender:function(){return this.ui={$emailForm:this.$(".js-modal-title-form-collapsed"),$googleButton:this.$("#google-signup-button"),$facebookButton:this.$("#fb-signup-button"),$firstName:this.$(".js-modal-title-first-name"),$lastName:this.$(".js-modal-title-last-name"),$password:this.$(".js-modal-title-password"),$email:this.$(".js-modal-title-email"),$envelope:this.$(".js-modal-title-envelope")},new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id")}}),new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id")}}),this.$el.modal({backdrop:"static",keyboard:!1}),this.$el.on("hidden.bs.modal",function(){return Aedu.SignupToDownload.notifier.notifyAndLog("download_closed")})},expandEmailForm:function(){return this.ui.$emailForm.collapse("show")},submitSignup:function(t){if(t.preventDefault(),Aedu.SignupToDownload.notifier.notifyAndLog("attempted_submit"),this.saveFields(),!this.model.savingToServer)return this.model.save().done(function(t){return function(e){var i,s,o;return o=e[0],i=e[1],s=e[2],o?t.redirectToPage(i.redirect):(Aedu.SignupToDownload.notifier.notifyAndLog("validation_failure",{error:JSON.stringify(s)}),t.displayErrors(s))}}(this)).fail(function(){return alert("Something went wrong")})},saveFields:function(){return this.model.set({email:this.ui.$email.val(),first_name:this.ui.$firstName.val(),last_name:this.ui.$lastName.val(),password:this.ui.$password.val()})},renderErrorHTML:function(t){return"<div class='js-swp-splash-input-inner-error swp-splash-input-inner-error u-tcRed a-fadeInDownShort'>"+t+"</div>"},displayErrors:function(t){var e;return e=$(this.ui.$firstName).add(this.ui.$lastName).add(this.ui.$password).add(this.ui.$email),e.removeClass("TextInput--error").css({"padding-top":0}),this.ui.$envelope.css({"padding-top":0}),this.$(".js-swp-splash-input-inner-error").remove(),_.each(t,function(t){return function(e){var i,s;if(s=e[0],i=e[1],"user[email]"===s&&t.showErrorForEmail(t.ui.$email,i),"user[first_name]"===s&&t.showErrorForInput(t.ui.$firstName,i),"user[last_name]"===s&&t.showErrorForInput(t.ui.$lastName,i),"user[password]"===s)return t.showErrorForInput(t.ui.$password,i)}}(this))},showErrorForInput:function(t,e){return t.addClass("TextInput--error").after(this.renderErrorHTML(e.replace(/\.$/g,""))).css({"padding-top":10})},showErrorForEmail:function(t,e){return t.addClass("TextInput--error").css({"padding-top":10}),this.ui.$envelope.after(this.renderErrorHTML(e.replace(/\.$/g,""))).css({"padding-top":5})},termsClicked:function(){return Aedu.SignupToDownload.notifier.notifyAndLog("terms",{auvid:$auvid})},logTyping:function(t){if(!this.log[t.target.id])return Aedu.SignupToDownload.notifier.notifyAndLog("started_typing",{location:t.target.id}),this.log[t.target.id]=!0},redirectToPage:function(t){return window.location.replace(t)}})}.call(this);
//# sourceMappingURL=//academia.edu/assets/maps/signup_to_download-ade61aae9927a3bdf3d96808b082a7ebd50dc9608f48b9e37b52039627f9864a.js.map
